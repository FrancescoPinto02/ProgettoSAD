---
output:
  html_document:
    df_print: paged
---

# Dati Socio-Economici
In questo documento deve essere effettuata l`analisi univariata delle seguenti features:
* Mother's qualification
* Father's qualification
* Mother's occupation
* Father's occupation
* Scholarship holder
* Debtor
* Tuition fees up to date
* Unemployment rate
* Inflation rate
* GDP

Valutare di separare i dati dello studente (mothers qualification, ecc...) da quelli del Paese (GDP, Inflaction, ecc...)

```{r setup, include=FALSE}
# Caricamento Librerie
library(ggplot2)
library(dplyr)
library(here)

# Funzione per Calcolare la Frequenza Assoluta e Massima
calculate_frequency <- function(data, column) {
  freq <- table(data[[column]])
  return(list(freq = freq, max_freq = max(freq)))
}

# Funzione per creare Barplot
create_barplot <- function(freq, max_freq, main_title, xlab="", ylab, col_palette = rainbow) {
  
  # Creazione Barplot
  bp <- barplot(freq, 
                main = main_title,
                xlab = xlab,
                ylab = ylab,
                ylim = c(0, max_freq * 1.3),
                col = col_palette(length(freq)),
                space = 1)
  
  # Aggiunta Labels Freuquenza
  text(x = bp, y = freq, labels = freq, pos = 3, cex = 0.8, col = "black")
}
```

## Caricamento del Dataset
```{r}
if(file.exists(here("dataset/dataMod.csv"))){
  data <- read.csv(here("dataset/dataMod.csv"), sep = ",", header = TRUE, check.names = FALSE)
  
  # Visualizza le prime righe
  head(data)
  
} else{
  print("Il dataset non è stato trovato nella directory")
}

```

## Qualifica della madre
```{r}
freq_mother_qual <- table(data$`Mothers_qualification`)
max_freq_mother_qual <- max(freq_mother_qual)
num_categories_mother_qual <- length(freq_mother_qual)

# Margini
par(mar = c(8, 4, 4, 2))

# Barplot Qualifica Madre
bp_mother_qual <- barplot(freq_mother_qual, main = "Distribuzione della Qualifica della Madre", 
                          xlab = "ID della Qualifica", 
                          ylab = "Frequenza",
                          ylim = c(0, max_freq_mother_qual * 1.2),
                          col = rainbow(num_categories_mother_qual),
                          names.arg = names(freq_mother_qual),
                          cex.names = 0.8, las = 2)

text(x = bp_mother_qual, y = freq_mother_qual, labels = freq_mother_qual, pos = 3, cex = 0.8, col = "black")

```

Valutare di accorpare le qualifiche in categorie più ampie (Istruzione Primaria e di Base, Istruzione Secondaria, ...)

```{r}
# Calcola la frequenza relativa
freq_table <- prop.table(table(data$Mothers_qualification)) * 100

# Sostituisci le categorie a bassa frequenza con "Altro"
low_freq_categories <- names(freq_table[freq_table < 1])

data$Mothers_qualification_grouped <- ifelse(data$Mothers_qualification %in% low_freq_categories, 
                                        "Altro", 
                                        as.character(data$Mothers_qualification))

# Ordinamento Categorie
numeric_categories <- sort(as.numeric(setdiff(unique(data$Mothers_qualification_grouped), "Altro")))
data$Mothers_qualification_grouped <- factor(data$Mothers_qualification_grouped, 
                                        levels = c(as.character(numeric_categories), "Altro"))

# Tabella di contingenza
target_MotherQual_table <- table(data$Target, data$Mothers_qualification_grouped)


target_MotherQual_relative <- prop.table(target_MotherQual_table, margin = 2) * 100
max_percent <- max(target_MotherQual_relative)

# Barplot ApplicationMode/Target
bp_relative <- barplot(target_MotherQual_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Qualifica della Madre",
                       xlab = "Codice Qualifica", 
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"), 
                       ylim = c(0, max_percent * 1.2),
                       las = 1)

# Aggiungi la legenda
legend("top", inset = c(0, -0.05), 
       legend = rownames(target_MotherQual_relative), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)


```


## Qualifica del padre
```{r}
# Calcola la frequenza per ciascun ID di Father's Qualification
freq_father_qual <- table(data$`Fathers_qualification`)
max_freq_father_qual <- max(freq_father_qual)
num_categories_father_qual <- length(freq_father_qual)

# Imposta i margini per lasciare più spazio alle etichette in basso
par(mar = c(8, 4, 4, 2))

# Crea il grafico a barre per Father's Qualification usando gli ID come etichette
bp_father_qual <- barplot(freq_father_qual, main = "Distribuzione della Qualifica del Padre", 
                          xlab = "ID della Qualifica", 
                          ylab = "Frequenza",
                          ylim = c(0, max_freq_father_qual * 1.2),
                          col = rainbow(num_categories_father_qual),
                          names.arg = names(freq_father_qual),  # Usa gli ID come etichette
                          cex.names = 0.8, las = 2)  # Ruota e riduce le dimensioni delle etichette

# Aggiungi le frequenze assolute sopra ogni barra
text(x = bp_father_qual, y = freq_father_qual, labels = freq_father_qual, pos = 3, cex = 0.8, col = "black")

```

Anche qui, valutare di accorpare le qualifiche in categorie più ampie (Istruzione Primaria e di Base, Istruzione Secondaria, ...)

```{r}
# Calcola la frequenza relativa
freq_table <- prop.table(table(data$Fathers_qualification)) * 100

# Sostituisci le categorie a bassa frequenza con "Altro"
low_freq_categories <- names(freq_table[freq_table < 1])

data$Father_qualification_grouped <- ifelse(data$Fathers_qualification %in% low_freq_categories, 
                                        "Altro", 
                                        as.character(data$Fathers_qualification))

# Ordinamento Categorie
numeric_categories <- sort(as.numeric(setdiff(unique(data$Father_qualification_grouped), "Altro")))
data$Father_qualification_grouped <- factor(data$Father_qualification_grouped, 
                                        levels = c(as.character(numeric_categories), "Altro"))

# Tabella di contingenza
target_FatherQual_table <- table(data$Target, data$Father_qualification_grouped)


target_FatherQual_relative <- prop.table(target_FatherQual_table, margin = 2) * 100
max_percent <- max(target_FatherQual_relative)

# Barplot ApplicationMode/Target
bp_relative <- barplot(target_FatherQual_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Qualifica del Padre",
                       xlab = "Codice Qualifica", 
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"), 
                       ylim = c(0, max_percent * 1.2),
                       las = 1)

# Aggiungi la legenda
legend("top", inset = c(0, -0.05), 
       legend = rownames(target_FatherQual_relative), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)


```


## Occupazione della madre

```{r}
# Crea la tabella di frequenza per Mother's Occupation
freq_mother_occ <- table(data$`Mothers_occupation`)
max_freq_mother_occ <- max(freq_mother_occ)
num_categories_mother_occ <- length(freq_mother_occ)

# Imposta i margini per lasciare più spazio alle etichette in basso
par(mar = c(8, 4, 4, 2))

# Crea il grafico a barre per Mother's Occupation usando gli ID come etichette
bp_mother_occ <- barplot(freq_mother_occ, main = "Distribuzione della Occupazione della Madre", 
                         xlab = "ID dell'Occupazione", 
                         ylab = "Frequenza",
                         ylim = c(0, max_freq_mother_occ * 1.2),
                         col = rainbow(num_categories_mother_occ),
                         names.arg = names(freq_mother_occ),  # Usa gli ID come etichette
                         cex.names = 0.8, las = 2)  # Ruota e riduce le dimensioni delle etichette

```

Valutare di accorpare i tipi di occupazione in categorie più ampie (Studenti, Impiegati e Personale Amministrativo, Lavoratori nei Servizi e nella Sicurezza, ...)

```{r}
# Calcola la frequenza relativa
freq_table <- prop.table(table(data$Mothers_occupation)) * 100

# Sostituisci le categorie a bassa frequenza con "Altro"
low_freq_categories <- names(freq_table[freq_table < 1])

data$Mothers_occupation_grouped <- ifelse(data$Mothers_occupation %in% low_freq_categories, 
                                        "Altro", 
                                        as.character(data$Mothers_occupation))

# Ordinamento Categorie
numeric_categories <- sort(as.numeric(setdiff(unique(data$Mothers_occupation_grouped), "Altro")))
data$Mothers_occupation_grouped <- factor(data$Mothers_occupation_grouped, 
                                        levels = c(as.character(numeric_categories), "Altro"))

# Tabella di contingenza
target_MothersOccupation_table <- table(data$Target, data$Mothers_occupation_grouped)


target_MothersOccupation_relative <- prop.table(target_MothersOccupation_table, margin = 2) * 100
max_percent <- max(target_MothersOccupation_relative)

# Barplot ApplicationMode/Target
bp_relative <- barplot(target_MothersOccupation_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Occupazione della Madre",
                       xlab = "Codice Occupazione", 
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"), 
                       ylim = c(0, max_percent * 1.2),
                       las = 1)

# Aggiungi la legenda
legend("top", inset = c(0, -0.05), 
       legend = rownames(target_MothersOccupation_relative), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)


```


## Occupazione del padre
```{r}
# Crea la tabella di frequenza per Father's Occupation
freq_father_occ <- table(data$`Fathers_occupation`)
max_freq_father_occ <- max(freq_father_occ)
num_categories_father_occ <- length(freq_father_occ)

# Imposta i margini per lasciare più spazio alle etichette in basso
par(mar = c(8, 4, 4, 2))

# Crea il grafico a barre per Father's Occupation usando gli ID come etichette
bp_father_occ <- barplot(freq_father_occ, main = "Distribuzione della Occupazione del Padre", 
                         xlab = "ID dell'Occupazione", 
                         ylab = "Frequenza",
                         ylim = c(0, max_freq_father_occ * 1.2),
                         col = rainbow(num_categories_father_occ),
                         names.arg = names(freq_father_occ),  # Usa gli ID come etichette
                         cex.names = 0.8, las = 2)  # Ruota e riduce le dimensioni delle etichette

```

Anche qui, valutare di accorpare i tipi di occupazione in categorie più ampie (Studenti, Impiegati e Personale Amministrativo, Lavoratori nei Servizi e nella Sicurezza, ...)

```{r}
# Calcola la frequenza relativa
freq_table <- prop.table(table(data$Fathers_occupation)) * 100

# Sostituisci le categorie a bassa frequenza con "Altro"
low_freq_categories <- names(freq_table[freq_table < 1])

data$Fathers_occupation_grouped <- ifelse(data$Fathers_occupation %in% low_freq_categories, 
                                        "Altro", 
                                        as.character(data$Fathers_occupation))

# Ordinamento Categorie
numeric_categories <- sort(as.numeric(setdiff(unique(data$Fathers_occupation_grouped), "Altro")))
data$Fathers_occupation_grouped <- factor(data$Fathers_occupation_grouped, 
                                        levels = c(as.character(numeric_categories), "Altro"))

# Tabella di contingenza
target_FathersOccupation_table <- table(data$Target, data$Fathers_occupation_grouped)


target_FathersOccupation_relative <- prop.table(target_FathersOccupation_table, margin = 2) * 100
max_percent <- max(target_FathersOccupation_relative)

# Barplot ApplicationMode/Target
bp_relative <- barplot(target_FathersOccupation_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Occupazione del Padre",
                       xlab = "Codice Occupazione", 
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"), 
                       ylim = c(0, max_percent * 1.2),
                       las = 1)

# Aggiungi la legenda
legend("top", inset = c(0, -0.05), 
       legend = rownames(target_FathersOccupation_relative), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)


```


## Borsista 
```{r}
# Label
data$`Scholarship_holder` <- factor(data$`Scholarship_holder`, levels = c(0, 1), labels = c("Non Borsisti", "Borsisti"))

#Barplot Studenti Borsisti
freq_data <- calculate_frequency(data, "Scholarship_holder")
app_mode_bp <- create_barplot(freq_data$freq,
                              freq_data$max_freq,
                              main_title = "Distribuzione Studenti Borsisti",
                              ylab = "Frequenza Assoluta"
)
```

```{r}
# Tabella di contingenza
target_Scholarship_holder_table <- table(data$Target, data$`Scholarship_holder`)

# Calcola la frequenza relativa in percentuale
target_Scholarship_holder_relative <- prop.table(target_Scholarship_holder_table, margin = 2) * 100
max_percent <- max(target_Scholarship_holder_relative)

# Crea il barplot con barre affiancate per ciascun gruppo
bp_relative <- barplot(target_Scholarship_holder_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Studenti Borsisti",
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"),
                       ylim = c(0, max_percent * 1.2))

# Aggiungi la legenda 
legend("top", inset = c(0, 0), 
       legend = c("Dropout", "Enrolled", "Graduate"), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)

# Aggiungi i valori percentuali 
for (i in seq_len(ncol(target_Scholarship_holder_relative))) {
  text(x = bp_relative[, i], 
       y = target_Scholarship_holder_relative[, i], 
       labels = paste0(round(target_Scholarship_holder_relative[, i], 1), "%"), 
       pos = 3, cex = 0.8, col = "black")
}

```
```{r}
# Tabella di contingenza
target_Scholarship_holder_table <- table(data$Target, data$`Scholarship_holder`)

# Calcola la frequenza relativa in percentuale
target_Scholarship_holder_relative <- prop.table(target_Scholarship_holder_table, margin = 2) * 100
max_percent <- max(target_Scholarship_holder_relative)

# Crea il barplot con barre affiancate per ciascun gruppo
bp_relative <- barplot(target_Scholarship_holder_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Studenti Borsisti",
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"),
                       ylim = c(0, max_percent * 1.2))

# Aggiungi la legenda 
legend("top", inset = c(0, 0), 
       legend = c("Dropout", "Enrolled", "Graduate"), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)

# Aggiungi i valori percentuali 
for (i in seq_len(ncol(target_Scholarship_holder_relative))) {
  text(x = bp_relative[, i], 
       y = target_Scholarship_holder_relative[, i], 
       labels = paste0(round(target_Scholarship_holder_relative[, i], 1), "%"), 
       pos = 3, cex = 0.8, col = "black")
}
```


## Debitore
```{r}
# Label
data$`Debtor` <- factor(data$`Debtor`, levels = c(0, 1), labels = c("Non Debitore", "Debitore"))

#Barplot Studenti Debitori
freq_data <- calculate_frequency(data, "Debtor")
app_mode_bp <- create_barplot(freq_data$freq,
                              freq_data$max_freq,
                              main_title = "Distribuzione Studenti Debitori",
                              ylab = "Frequenza Assoluta"
)

```
```{r}
# Tabella di contingenza
target_Debtor_table <- table(data$Target, data$`Debtor`)

# Calcola la frequenza relativa in percentuale
target_Debtor_relative <- prop.table(target_Debtor_table, margin = 2) * 100
max_percent <- max(target_Debtor_relative)

# Crea il barplot con barre affiancate per ciascun gruppo
bp_relative <- barplot(target_Debtor_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target per Studenti Debitori",
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"),
                       ylim = c(0, max_percent * 1.2))

# Aggiungi la legenda 
legend("top", inset = c(0, -0.1), 
       legend = c("Dropout", "Enrolled", "Graduate"), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)

# Aggiungi i valori percentuali 
for (i in seq_len(ncol(target_Debtor_relative))) {
  text(x = bp_relative[, i], 
       y = target_Debtor_relative[, i], 
       labels = paste0(round(target_Debtor_relative[, i], 1), "%"), 
       pos = 3, cex = 0.8, col = "black")
}
```


## Tasse universitarie in regola
```{r}
# Label
data$`Tuition_fees_up_to_date` <- factor(data$`Tuition_fees_up_to_date`, 
                                         levels = c(1, 0), 
                                         labels = c("Tasse in regola", "Tasse non in regola"))


#Barplot Tasse In Regola
freq_data <- calculate_frequency(data, "Tuition_fees_up_to_date")
app_mode_bp <- create_barplot(freq_data$freq,
                              freq_data$max_freq,
                              main_title = "Distribuzione degli Studenti con Tasse in Regola",
                              ylab = "Frequenza Assoluta"
)

```
```{r}
# Tabella di contingenza
target_fees_table <- table(data$Target, data$`Tuition_fees_up_to_date`)

# Calcola la frequenza relativa in percentuale
target_fees_relative <- prop.table(target_fees_table, margin = 2) * 100
max_percent <- max(target_fees_relative)

# Crea il barplot con barre affiancate per ciascun gruppo
bp_relative <- barplot(target_fees_relative, 
                       beside = TRUE, 
                       main = "Distribuzione della Variabile Target rispetto alle Tasse in Regola",
                       ylab = "Frequenza Relativa (%)", 
                       col = c("#FF6A6A", "#32CD32", "#6495ED"),
                       ylim = c(0, max_percent * 1.2))

# Aggiungi la legenda 
legend("top", inset = c(0, -0.1), 
       legend = c("Dropout", "Enrolled", "Graduate"), 
       fill = c("#FF6A6A", "#32CD32", "#6495ED"), 
       xpd = TRUE, horiz = TRUE)

# Aggiungi i valori percentuali 
for (i in seq_len(ncol(target_fees_relative))) {
  text(x = bp_relative[, i], 
       y = target_fees_relative[, i], 
       labels = paste0(round(target_fees_relative[, i], 1), "%"), 
       pos = 3, cex = 0.8, col = "black")
}
```


## Tasso di disoccupazione
```{r}
# Calcola gli indici di sintesi per "Unemployment_rate"
summary_stats_unemployment <- list(
  Media = mean(data$Unemployment_rate, na.rm = TRUE),
  Mediana = median(data$Unemployment_rate, na.rm = TRUE),
  Moda = as.numeric(names(sort(table(data$Unemployment_rate), decreasing = TRUE)[1])),
  Varianza = var(data$Unemployment_rate, na.rm = TRUE),
  Deviazione_Standard = sd(data$Unemployment_rate, na.rm = TRUE),
  Coefficiente_Variabilità = sd(data$Unemployment_rate, na.rm = TRUE) / mean(data$Unemployment_rate, na.rm = TRUE) * 100,
  Quantile_1 = quantile(data$Unemployment_rate, 0.25, na.rm = TRUE),
  Quantile_3 = quantile(data$Unemployment_rate, 0.75, na.rm = TRUE),
  Minimo = min(data$Unemployment_rate, na.rm = TRUE),
  Massimo = max(data$Unemployment_rate, na.rm = TRUE),
  Range = max(data$Unemployment_rate, na.rm = TRUE) - min(data$Unemployment_rate, na.rm = TRUE),
  IQR = IQR(data$Unemployment_rate, na.rm = TRUE)
)

summary_stats_unemployment

```

```{r}
# Crea l'istogramma della distribuzione
ggplot(data, aes(x = Unemployment_rate)) +
  geom_histogram(binwidth = 0.8, color = "black", fill = "lightblue") +
  labs(title = "Distribuzione del Tasso di Disoccupazione",
       x = "Tasso di Disoccupazione (%)",
       y = "Frequenza") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```

Valutare se trattarla come discreta (utilizzare barplot in tal caso)

```{r}
# Crea il boxplot di "Unemployment_Rate"
ggplot(data, aes(x = Unemployment_rate, y = "")) +
  geom_boxplot(fill = "lightblue", color = "darkblue", width = 0.3) +
  labs(title = "Boxplot Tasso di Disoccupazione",
       x = "Tasso di Disoccupazione") +
  theme_minimal() +
  stat_boxplot(geom = "errorbar",
               width = 0.15) +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

```
```{r}
# BoxPlot Tasso di Disoccupazione suddivisi per Target
ggplot(data, aes(x = Target, y = Unemployment_rate, fill = Target)) +
  geom_boxplot(notch = TRUE,
               outlier.color = "darkblue",
               outlier.shape = 1,
               width = 0.6) +
  stat_boxplot(geom = "errorbar",
               width = 0.2,
               color = "black") +
  labs(title = "Tasso di Disoccupazione per Categorie Target",
       x = "Target",
       y = "Tasso di Disoccupazione") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

```
```{r}
sort(unique(data$Unemployment_rate))
```


## Tasso di inflazione
```{r}
# Calcola gli indici di sintesi per "Inflation_rate"
summary_stats_inflation <- list(
  Media = mean(data$Inflation_rate, na.rm = TRUE),
  Mediana = median(data$Inflation_rate, na.rm = TRUE),
  Moda = as.numeric(names(sort(table(data$Inflation_rate), decreasing = TRUE)[1])),
  Varianza = var(data$Inflation_rate, na.rm = TRUE),
  Deviazione_Standard = sd(data$Inflation_rate, na.rm = TRUE),
  Coefficiente_Variabilità = sd(data$Inflation_rate, na.rm = TRUE) / mean(data$Inflation_rate, na.rm = TRUE) * 100,
  Quantile_1 = quantile(data$Inflation_rate, 0.25, na.rm = TRUE),
  Quantile_3 = quantile(data$Inflation_rate, 0.75, na.rm = TRUE),
  Minimo = min(data$Inflation_rate, na.rm = TRUE),
  Massimo = max(data$Inflation_rate, na.rm = TRUE),
  Range = max(data$Inflation_rate, na.rm = TRUE) - min(data$Inflation_rate, na.rm = TRUE),
  IQR = IQR(data$Inflation_rate, na.rm = TRUE)
)

summary_stats_inflation

```

```{r}
# Crea l'istogramma della distribuzione
ggplot(data, aes(x = Inflation_rate)) +
  geom_histogram(binwidth = 0.5, color = "black", fill = "lightblue") +
  labs(title = "Distribuzione del Tasso di Inflazione",
       x = "Tasso di Inflazione (%)",
       y = "Frequenza") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```
Anche qui, valutare se trattarla come discreta (utilizzare barplot in tal caso)

```{r}
# Crea il boxplot di "Inflation_rate"
ggplot(data, aes(x = Inflation_rate, y = "")) +
  geom_boxplot(fill = "lightblue", color = "darkblue", width = 0.3) +
  labs(title = "Boxplot Tasso di Inflazione",
       x = "Tasso di Inflazione") +
  theme_minimal() +
  stat_boxplot(geom = "errorbar",
               width = 0.15) +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

```
```{r}
# BoxPlot Tasso di Inflazione suddivisi per Target
ggplot(data, aes(x = Target, y = Inflation_rate, fill = Target)) +
  geom_boxplot(notch = TRUE,
               outlier.color = "darkblue",
               outlier.shape = 1,
               width = 0.6) +
  stat_boxplot(geom = "errorbar",
               width = 0.2,
               color = "black") +
  labs(title = "Tasso di Inflazione per Categorie Target",
       x = "Target",
       y = "Tasso di Inflazione") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

```
```{r}
sort(unique(data$Inflation_rate))
```


## PIL
```{r}
# Calcola gli indici di sintesi per "GDP"
summary_stats_gdp <- list(
  Media = mean(data$GDP, na.rm = TRUE),
  Mediana = median(data$GDP, na.rm = TRUE),
  Moda = as.numeric(names(sort(table(data$GDP), decreasing = TRUE)[1])),
  Varianza = var(data$GDP, na.rm = TRUE),
  Deviazione_Standard = sd(data$GDP, na.rm = TRUE),
  Coefficiente_Variabilità = sd(data$GDP, na.rm = TRUE) / mean(data$GDP, na.rm = TRUE) * 100,
  Quantile_1 = quantile(data$GDP, 0.25, na.rm = TRUE),
  Quantile_3 = quantile(data$GDP, 0.75, na.rm = TRUE),
  Minimo = min(data$GDP, na.rm = TRUE),
  Massimo = max(data$GDP, na.rm = TRUE),
  Range = max(data$GDP, na.rm = TRUE) - min(data$GDP, na.rm = TRUE),
  IQR = IQR(data$GDP, na.rm = TRUE)
)

summary_stats_gdp

```

```{r}
# Crea l'istogramma della distribuzione
ggplot(data, aes(x = GDP)) +
  geom_histogram(binwidth = 0.5, color = "black", fill = "lightblue") +
  labs(title = "Distribuzione del PIL",
       x = "PIL (Prodotto Interno Lordo)",
       y = "Frequenza") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r}
# Crea il boxplot di "GDP"
ggplot(data, aes(x = GDP, y = "")) +
  geom_boxplot(fill = "lightblue", color = "darkblue", width = 0.3) +
  labs(title = "Boxplot del PIL",
       x = "PIL (Prodotto Interno Lordo)") +
  theme_minimal() +
  stat_boxplot(geom = "errorbar",
               width = 0.15) +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        plot.title = element_text(hjust = 0.5))

```



```{r}
# BoxPlot PIL suddivisi per Target
ggplot(data, aes(x = Target, y = GDP, fill = Target)) +
  geom_boxplot(notch = TRUE,
               outlier.color = "darkblue",
               outlier.shape = 1,
               width = 0.6) +
  stat_boxplot(geom = "errorbar",
               width = 0.2,
               color = "black") +
  labs(title = "PIL per Categorie Target",
       x = "Target",
       y = "PIL") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

```
```{r}
sort(unique(data$GDP))
```















